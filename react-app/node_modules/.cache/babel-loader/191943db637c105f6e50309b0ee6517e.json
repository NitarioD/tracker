{"ast":null,"code":"import _asyncToGenerator from\"/data/data/com.termux/files/home/chat-app/react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator.js\";import _slicedToArray from\"/data/data/com.termux/files/home/chat-app/react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray.js\";import _regeneratorRuntime from\"/data/data/com.termux/files/home/chat-app/react-app/node_modules/@babel/runtime/regenerator/index.js\";import axios from'axios';import{useEffect,useState}from'react';import{useNavigate}from'react-router-dom';import dp from'../images/user.jpeg';import Header from'../components/header.jsx';import MessageBox from'../components/message-box';import{jsx as _jsx}from\"react/jsx-runtime\";import{jsxs as _jsxs}from\"react/jsx-runtime\";function ChatPage(props){var navigate=useNavigate();var _useState=useState(''),_useState2=_slicedToArray(_useState,2),user=_useState2[0],setUser=_useState2[1];var _useState3=useState([]),_useState4=_slicedToArray(_useState3,2),chats=_useState4[0],setChats=_useState4[1];useEffect(function(){var getUser=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){var _yield$axios$get,data;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return axios.get('/user');case 2:_yield$axios$get=_context.sent;data=_yield$axios$get.data;setUser(data.user.username);case 5:case\"end\":return _context.stop();}}},_callee);}));return function getUser(){return _ref.apply(this,arguments);};}();getUser();},[]);useEffect(function(){var previewConvo=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _yield$axios$get2,data;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return axios.get('/conversations');case 2:_yield$axios$get2=_context2.sent;data=_yield$axios$get2.data;setChats(data);case 5:case\"end\":return _context2.stop();}}},_callee2);}));return function previewConvo(){return _ref2.apply(this,arguments);};}();previewConvo();},[]);var getEachUsername=function getEachUsername(arr){var userBox=arr.filter(function(eachUser){return eachUser!==user;});return userBox[0];};return/*#__PURE__*/_jsxs(\"div\",{children:[/*#__PURE__*/_jsx(Header,{user:user}),chats.map(function(chat){return/*#__PURE__*/_jsx(MessageBox,{setReceiver:props.setReceiver,img:dp,username:getEachUsername(chat.users),message:chat.messages[chat.messages.length-1].message},chat._id);}),/*#__PURE__*/_jsx(\"div\",{className:\"chat-user\",onClick:function onClick(){return navigate('/users');},children:/*#__PURE__*/_jsx(\"span\",{children:\"+\"})})]});}export default ChatPage;","map":{"version":3,"sources":["/data/data/com.termux/files/home/chat-app/react-app/src/pages/chat-page.jsx"],"names":["axios","useEffect","useState","useNavigate","dp","Header","MessageBox","ChatPage","props","navigate","user","setUser","chats","setChats","getUser","get","data","username","previewConvo","getEachUsername","arr","userBox","filter","eachUser","map","chat","setReceiver","users","messages","length","message","_id"],"mappings":"8ZAAA,MAAOA,CAAAA,KAAP,KAAkB,OAAlB,CACA,OAAQC,SAAR,CAAmBC,QAAnB,KAAkC,OAAlC,CACA,OAASC,WAAT,KAA4B,kBAA5B,CACA,MAAOC,CAAAA,EAAP,KAAe,qBAAf,CAGA,MAAOC,CAAAA,MAAP,KAAmB,0BAAnB,CACA,MAAOC,CAAAA,UAAP,KAAuB,2BAAvB,C,wFAEA,QAASC,CAAAA,QAAT,CAAkBC,KAAlB,CAAyB,CACvB,GAAMC,CAAAA,QAAQ,CAAEN,WAAW,EAA3B,CACA,cAAuBD,QAAQ,CAAC,EAAD,CAA/B,wCAAOQ,IAAP,eAAaC,OAAb,eACA,eAA0BT,QAAQ,CAAC,EAAD,CAAlC,yCAAQU,KAAR,eAAeC,QAAf,eAEAZ,SAAS,CAAE,UAAI,CACb,GAAMa,CAAAA,OAAO,0FAAE,mLACSd,CAAAA,KAAK,CAACe,GAAN,CAAU,OAAV,CADT,uCACLC,IADK,kBACLA,IADK,CAEbL,OAAO,CAACK,IAAI,CAACN,IAAL,CAAUO,QAAX,CAAP,CAFa,sDAAF,kBAAPH,CAAAA,OAAO,0CAAb,CAIAA,OAAO,GACR,CANQ,CAMN,EANM,CAAT,CAQAb,SAAS,CAAE,UAAI,CACb,GAAMiB,CAAAA,YAAY,2FAAE,0LACIlB,CAAAA,KAAK,CAACe,GAAN,CAAU,gBAAV,CADJ,yCACVC,IADU,mBACVA,IADU,CAElBH,QAAQ,CAACG,IAAD,CAAR,CAFkB,wDAAF,kBAAZE,CAAAA,YAAY,2CAAlB,CAIAA,YAAY,GACb,CANQ,CAMN,EANM,CAAT,CAOA,GAAMC,CAAAA,eAAe,CAAE,QAAjBA,CAAAA,eAAiB,CAACC,GAAD,CAAO,CAC5B,GAAMC,CAAAA,OAAO,CAAED,GAAG,CAACE,MAAJ,CAAW,SAACC,QAAD,QAAaA,CAAAA,QAAQ,GAAKb,IAA1B,EAAX,CAAf,CACA,MAAOW,CAAAA,OAAO,CAAC,CAAD,CAAd,CACD,CAHD,CAIA,mBAAQ,oCACR,KAAC,MAAD,EACA,IAAI,CAAGX,IADP,EADQ,CAIPE,KAAK,CAACY,GAAN,CAAW,SAACC,IAAD,qBAAS,KAAC,UAAD,EACrB,WAAW,CAAGjB,KAAK,CAACkB,WADC,CAGrB,GAAG,CAAGtB,EAHe,CAIrB,QAAQ,CAAGe,eAAe,CAACM,IAAI,CAACE,KAAN,CAJL,CAKrB,OAAO,CAAGF,IAAI,CAACG,QAAL,CAAeH,IAAI,CAACG,QAAL,CAAcC,MAAf,CAAwB,CAAtC,EAAyCC,OAL9B,EAEfL,IAAI,CAACM,GAFU,CAAT,EAAX,CAJO,cAWR,YAAK,SAAS,CAAC,WAAf,CAA2B,OAAO,CAAG,yBAAKtB,CAAAA,QAAQ,CAAC,QAAD,CAAb,EAArC,uBACE,2BADF,EAXQ,GAAR,CAgBD,CAED,cAAeF,CAAAA,QAAf","sourcesContent":["import axios from 'axios';\nimport {useEffect, useState} from 'react';\nimport { useNavigate } from 'react-router-dom';\nimport dp from '../images/user.jpeg' ;\n\n\nimport Header from '../components/header.jsx';\nimport MessageBox from '../components/message-box';\n\nfunction ChatPage(props) {\n  const navigate= useNavigate();\n  const [user, setUser]= useState('');\n  const [ chats, setChats]= useState([]);\n  \n  useEffect( ()=>{\n    const getUser= async ()=>{\n      const { data }= await axios.get('/user');\n      setUser(data.user.username);\n    }\n    getUser();\n  }, []);\n  \n  useEffect( ()=>{\n    const previewConvo= async ()=>{\n      const { data }= await axios.get('/conversations');\n      setChats(data);\n    }\n    previewConvo();\n  }, []);\n  const getEachUsername= (arr)=>{\n    const userBox= arr.filter((eachUser)=>(eachUser !== user));\n    return userBox[0];\n  }\n  return (<div>\n  <Header\n  user= {user}/>\n  \n  {chats.map( (chat)=>(<MessageBox\n  setReceiver= {props.setReceiver}\n  key= {chat._id}\n  img= {dp}\n  username= {getEachUsername(chat.users)}\n  message= {chat.messages[(chat.messages.length) -1].message} \n  />) )}\n  <div className='chat-user' onClick={ ()=>(navigate('/users'))} >\n    <span>+</span>\n  </div>\n  </div>\n  );\n}\n\nexport default ChatPage;\n"]},"metadata":{},"sourceType":"module"}